function y = IIR_highpass_50(x)
%DOFILTER 对输入 x 进行滤波并返回输出 y。

% MATLAB Code
% Generated by MATLAB(R) 9.11 and DSP System Toolbox 9.13.
% Generated on: 18-Nov-2022 14:34:58

%#codegen

% 要通过此函数生成 C/C++ 代码，请使用 codegen 命令。有关详细信息，请键入 'help codegen'。

persistent Hd;

if isempty(Hd)
    
    % 设计滤波器系数时使用了以下代码:
    %
    % N    = 50;     % Order
    % F3dB = 6000;   % 3-dB Frequency
    % Fs   = 48000;  % Sampling Frequency
    %
    % h = fdesign.highpass('n,f3db', N, F3dB, Fs);
    %
    % Hd = design(h, 'butter', ...
    %     'SystemObject', true);
    
    Hd = dsp.BiquadFilter( ...
        'Structure', 'Direct form II', ...
        'SOSMatrix', [1 -2 1 1 -1.38348530134873 0.956543676511203; 1 -2 1 1 ...
        -1.32597692324985 0.875214548253684; 1 -2 1 1 -1.273359763036 ...
        0.800802646665707; 1 -2 1 1 -1.22522232601436 0.732726030371816; 1 -2 1 ...
        1 -1.18119211298617 0.670457905953174; 1 -2 1 1 -1.14093288937615 ...
        0.613522765913272; 1 -2 1 1 -1.10414185787098 0.561492390184971; 1 -2 1 ...
        1 -1.07054686399639 0.513981894219676; 1 -2 1 1 -1.03990371674556 ...
        0.470645939783765; 1 -2 1 1 -1.01199367326454 0.431175177766481; 1 -2 1 ...
        1 -0.986621113804645 0.395292960066177; 1 -2 1 1 -0.963611417769736 ...
        0.362752335867527; 1 -2 1 1 -0.942809041582063 0.333333333333333; 1 -2 1 ...
        1 -0.924075792709786 0.306840518710848; 1 -2 1 1 -0.907289290416384 ...
        0.283100819502711; 1 -2 1 1 -0.892341601799501 0.261961595534586; 1 -2 1 ...
        1 -0.87913804090904 0.243288940651677; 1 -2 1 1 -0.867596118765068 ...
        0.226966197819818; 1 -2 1 1 -0.857644632650988 0.212892671191518; 1 -2 1 ...
        1 -0.849222883939774 0.200982519945221; 1 -2 1 1 -0.842280014787242 ...
        0.191163820227929; 1 -2 1 1 -0.836774455207095 0.183377783201232; 1 -2 1 ...
        1 -0.832673473270674 0.177578118927698; 1 -2 1 1 -0.829952822414805 ...
        0.173730537588846; 1 -2 1 1 -0.828596481074458 0.17181238127012], ...
        'ScaleValues', [0.835007244464984; 0.800297867875883; ...
        0.768540602425428; 0.739487089096544; 0.712912504734836; ...
        0.688613913822355; 0.666408562013989; 0.646132189554016; ...
        0.627637414132332; 0.610792212757756; 0.595478518467705; ...
        0.581590938409316; 0.569035593728849; 0.557729077855158; ...
        0.547597527479774; 0.538575799333522; 0.530606745390179; ...
        0.523640579146222; 0.517634325960626; 0.512551350971249; ...
        0.508360958753793; 0.505038059602082; 0.502562898049593; ...
        0.500920840000913; 0.500102215586144; 1]);
end

s = double(x);
y = step(Hd,s);

