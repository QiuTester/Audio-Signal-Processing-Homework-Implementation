function y = IIR_lowpass_50(x)
%DOFILTER 对输入 x 进行滤波并返回输出 y。

% MATLAB Code
% Generated by MATLAB(R) 9.11 and DSP System Toolbox 9.13.
% Generated on: 17-Nov-2022 18:03:05

%#codegen

% 要通过此函数生成 C/C++ 代码，请使用 codegen 命令。有关详细信息，请键入 'help codegen'。

persistent Hd;

if isempty(Hd)
    
    % 设计滤波器系数时使用了以下代码:
    %
    % N    = 50;     % Order
    % F3dB = 3000;   % 3-dB Frequency
    % Fs   = 48000;  % Sampling Frequency
    %
    % h = fdesign.lowpass('n,f3db', N, F3dB, Fs);
    %
    % Hd = design(h, 'butter', ...
    %     'SystemObject', true);
    
    Hd = dsp.BiquadFilter( ...
        'Structure', 'Direct form II', ...
        'SOSMatrix', [1 2 1 1 -1.8258121148929 0.97624479235944; 1 2 1 1 ...
        -1.78352764896639 0.930476416247046; 1 2 1 1 -1.7433911655525 ...
        0.887032999652695; 1 2 1 1 -1.70539317629987 0.845904272458848; 1 2 1 1 ...
        -1.66951304701401 0.80706790037435; 1 2 1 1 -1.6357214865277 ...
        0.770492178868266; 1 2 1 1 -1.60398269820006 0.736138361935691; 1 2 1 1 ...
        -1.57425622265844 0.703962656667262; 1 2 1 1 -1.54649850261889 ...
        0.673917916998558; 1 2 1 1 -1.52066420099668 0.645955070422668; 1 2 1 1 ...
        -1.49670730261685 0.62002431047315; 1 2 1 1 -1.47458202809851 ...
        0.596076085905171; 1 2 1 1 -1.45424358625158 0.574061915083955; 1 2 1 1 ...
        -1.43564878883994 0.553935051399575; 1 2 1 1 -1.41875654900428 ...
        0.535651022755988; 1 2 1 1 -1.40352828212311 0.519168065459832; 1 2 1 1 ...
        -1.38992822549713 0.504447470244346; 1 2 1 1 -1.37792369101677 ...
        0.491453855754655; 1 2 1 1 -1.36748526293577 0.480155382616468; 1 2 1 1 ...
        -1.35858695103272 0.470523919216845; 1 2 1 1 -1.35120630778918 ...
        0.462535168536892; 1 2 1 1 -1.3453245167364 0.456168763777618; 1 2 1 1 ...
        -1.34092645780358 0.451408339092306; 1 2 1 1 -1.33800075431796 ...
        0.448241580459098; 1 2 1 1 -1.33653980523987 0.446660260571952], ...
        'ScaleValues', [0.0376081693666339; 0.0367371918201652; ...
        0.035910458525048; 0.0351277740397452; 0.0343887133400858; ...
        0.0336926730851407; 0.0330389159339084; 0.0324266085022054; ...
        0.0318548535949158; 0.0313227173564979; 0.0308292519640741; ...
        0.0303735144516643; 0.0299545822080925; 0.0295715656399083; ...
        0.0292236184379266; 0.0289099458341816; 0.0286298111868029; ...
        0.0283825411844721; 0.0281675299201752; 0.0279842420460303; ...
        0.0278322151869281; 0.0277110617603035; 0.0276204703221808; ...
        0.0275602065352849; 0.0275301138330202; 1]);
end

s = double(x);
y = step(Hd,s);

